# Example Datapack for E92 Pulse
# Place this file in ~/.config/e92_pulse/datapacks/
#
# IMPORTANT: This is an example template. Do NOT include proprietary BMW data.
# Only use publicly available information or your own definitions.

# Metadata about this datapack
metadata:
  id: "example-datapack"
  name: "Example Datapack"
  version: "1.0.0"
  description: "Example datapack showing the schema format"
  author: "E92 Pulse Contributors"
  license: "MIT"
  # Minimum E92 Pulse version required
  requires_version: ">=0.1.0"

# Additional module definitions
# These are EXAMPLES ONLY - addresses shown may not be accurate
modules:
  # Example: Custom aftermarket module
  - module_id: "CUSTOM1"
    name: "Example Custom Module"
    description: "Demonstration module definition"
    address: 0xE0  # Example address - replace with actual
    category: "body"
    dtc_prefix: "B"
    supports_extended_session: true
    priority: 10
    variants:
      - "V1.0"
      - "V2.0"

  # Example: Another module
  - module_id: "CUSTOM2"
    name: "Secondary Example Module"
    description: "Another demonstration module"
    address: 0xE1  # Example address
    category: "chassis"
    dtc_prefix: "C"
    priority: 5

# DTC descriptions
# Map DTC codes to human-readable descriptions
# These are EXAMPLE descriptions only
dtc_descriptions:
  # Powertrain examples
  "P0100": "Mass Air Flow (MAF) Circuit Malfunction"
  "P0101": "MAF Circuit Range/Performance Problem"
  "P0102": "MAF Circuit Low Input"
  "P0103": "MAF Circuit High Input"
  "P0171": "System Too Lean (Bank 1)"
  "P0172": "System Too Rich (Bank 1)"
  "P0174": "System Too Lean (Bank 2)"
  "P0175": "System Too Rich (Bank 2)"

  # Chassis examples
  "C1000": "ABS Hydraulic Unit Circuit"
  "C1001": "Wheel Speed Sensor Front Left"
  "C1002": "Wheel Speed Sensor Front Right"
  "C1003": "Wheel Speed Sensor Rear Left"
  "C1004": "Wheel Speed Sensor Rear Right"

  # Body examples
  "B1000": "General Body Electrical Fault"
  "B1001": "Driver Door Module Communication"
  "B1002": "Passenger Door Module Communication"

# Live data definitions (for future live data feature)
# These define how to read and display live sensor values
live_data:
  - id: "engine_rpm"
    name: "Engine RPM"
    description: "Current engine rotational speed"
    did: 0x100C  # Example DID
    unit: "rpm"
    format: "integer"
    # Value calculation: raw_value * scale + offset
    scale: 0.25
    offset: 0
    min_value: 0
    max_value: 9000

  - id: "coolant_temp"
    name: "Engine Coolant Temperature"
    description: "Engine coolant temperature"
    did: 0x1005  # Example DID
    unit: "°C"
    format: "integer"
    scale: 1.0
    offset: -40  # Raw value 40 = 0°C
    min_value: -40
    max_value: 150

  - id: "intake_air_temp"
    name: "Intake Air Temperature"
    description: "Air temperature at intake"
    did: 0x100F  # Example DID
    unit: "°C"
    format: "integer"
    scale: 1.0
    offset: -40
    min_value: -40
    max_value: 80

  - id: "battery_voltage"
    name: "Battery Voltage"
    description: "Vehicle battery voltage"
    did: 0x1001  # Example DID
    unit: "V"
    format: "decimal"
    scale: 0.1
    offset: 0
    min_value: 0
    max_value: 20
    decimals: 1

# Service routine definitions (for future expansion)
# These are SAFE routines only - dangerous routines are blocked
service_routines:
  - id: "reset_adaptation"
    name: "Reset Throttle Adaptation"
    description: "Reset throttle body adaptation values"
    module_id: "DME"
    routine_id: 0x0400  # Example routine ID
    category: "maintenance"
    requires_confirmation: true
    preconditions:
      - "Ignition ON"
      - "Engine OFF"
      - "Throttle closed"
